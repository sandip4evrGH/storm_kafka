You‚Äôre trying to install Apache Airflow on an EC2 instance that has no internet access, and you want to use an Airflow source bundle from another isolated server. This is a classic ‚Äúair‚Äëgapped installation‚Äù problem, and it is solvable ‚Äî but only if you prepare the artifacts correctly on a machine that does have internet.

Given your automation-heavy workflow and preference for clean, atomic solutions, I‚Äôll give you the production-grade, end‚Äëto‚Äëend method that works reliably in fully isolated AWS environments.

---

üöÄ Installing Airflow on an EC2 Instance With No Internet Access

üß© High-Level Strategy
You need to:

1. Prepare an offline Airflow installation bundle on a machine that does have internet.
2. Transfer the bundle to the isolated EC2 instance (S3 VPC endpoint, SCP over bastion, EFS, etc.).
3. Install Airflow from local wheels, not PyPI.
4. Install system dependencies offline.
5. Start Airflow normally (systemd, supervisord, or docker-compose).

This avoids all outbound traffic.

---

1Ô∏è‚É£ Prepare the Offline Airflow Bundle (on a machine with internet)

Create a clean virtual environment
`bash
python3 -m venv airflow-build
source airflow-build/bin/activate
`

Install Airflow version you want
Example:
`bash
pip install "apache-airflow==2.9.1" --constraint "https://raw.githubusercontent.com/apache/airflow/constraints-2.9.1/constraints-3.10.txt"
`

Download all required wheels
This is the critical step.

`bash
mkdir airflow-offline
pip download apache-airflow==2.9.1 \
  --dest airflow-offline \
  --constraint "https://raw.githubusercontent.com/apache/airflow/constraints-2.9.1/constraints-3.10.txt"
`

If you need providers:
`bash
pip download apache-airflow-providers-amazon \
  --dest airflow-offline
`

If you need extras:
`bash
pip download "apache-airflow[postgres,celery,redis]" \
  --dest airflow-offline
`

You now have a directory containing 100% of the wheels needed to install Airflow offline.

Optional: Package it as a tarball
`bash
tar -czvf airflow-offline-bundle.tar.gz airflow-offline/
`

---

2Ô∏è‚É£ Transfer the Bundle to the Isolated EC2 Instance

Options:

- SCP via bastion
- S3 bucket + VPC endpoint
- AWS Systems Manager Session Manager
- EFS mount

Example (SCP):
`bash
scp airflow-offline-bundle.tar.gz ec2-user@bastion:/tmp/
`

---

3Ô∏è‚É£ Install Airflow Offline on the Isolated EC2

Extract the bundle
`bash
tar -xzvf airflow-offline-bundle.tar.gz
cd airflow-offline
`

Install system dependencies (offline)
Airflow needs:

`bash
sudo yum install -y gcc gcc-c++ python3-devel libffi-devel openssl-devel cyrus-sasl-devel
`

If your EC2 has no yum internet, you must also mirror RPMs from a connected machine:

`bash
yumdownloader --resolve gcc gcc-c++ python3-devel libffi-devel openssl-devel cyrus-sasl-devel
`

Transfer those RPMs and install:

`bash
sudo rpm -Uvh *.rpm
`

Install Airflow from local wheels
`bash
python3 -m venv airflow
source airflow/bin/activate

pip install --no-index --find-links . apache-airflow
`

If you have providers:
`bash
pip install --no-index --find-links . apache-airflow-providers-amazon
`

---

4Ô∏è‚É£ Initialize Airflow

`bash
export AIRFLOW_HOME=~/airflow
airflow db init
airflow users create \
  --username admin \
  --password admin \
  --firstname Sandip \
  --lastname Admin \
  --role Admin \
  --email admin@example.com
`

---

5Ô∏è‚É£ Start Airflow Services

Webserver
`bash
airflow webserver -p 8080
`

Scheduler
`bash
airflow scheduler
`

For production, you‚Äôll want systemd units ‚Äî I can generate those too if you want.

---

üß± Optional: Fully Automated Bash Script (Airflow Offline Installer)
If you want, I can generate a single atomic Bash script that:

- Installs system dependencies (from local RPMs)
- Creates venv
- Installs Airflow from local wheels
- Configures AIRFLOW_HOME
- Creates admin user
- Sets up systemd services

Just say the word and I‚Äôll produce the full script in one shot.

---

If you tell me:

- Airflow version
- Python version
- Providers you need
- EC2 OS (Amazon Linux 2, AL2023, Ubuntu)

‚Ä¶I‚Äôll tailor the bundle and installer exactly to your environment.